# 特征加工 {#task_1271890 .task}

本文档为您介绍在数据精炼场景中进行特征加工的方法，包括特征加工任务创建、设备数据选择、特征表字段配置、关联映射配置以及数据过滤规则配置。

完成[数据模型的创建](cn.zh-CN/快速开始-行业顾问/数据工厂/配置数据精炼场景/数据建模.md#)。

1.  进入场景配置页面，单击右上角的**特征加工**。
2.  在特征加工页面，单击右上角的**新建**。
3.  在新建特征加工对话框中，输入特征加工的**名称**，并选择特征加工的**类型**（**离线特征加工**），单击**新建**。![新建离线特征加工任务](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/1014105/156706454252403_zh-CN.png)

 

    |参数|说明|
    |--|--|
    |**名称**|特征加工任务的名称。|
    |**类型**|支持**离线特征加工**和**在线特征加工**。|
    |**生效日期**|选择后，特征加工任务仅在生效日期内执行。|
    |**周期**|特征加工任务每隔多久执行一次。|
    |**依赖上一周期**|勾选后，会在上个周期的基础上继续执行。去勾选，对原始数据进行特征加工。|

    **说明：** 离线特征加工对**目标表**的要求是必须是ds分区表，分区字段必须包含ds和system\_code字段，且ds必须在system\_code之前。实时特征加工的目标表不需要添加ds分区字段。

    新建成功后，系统显示**特征新建成功**，且该特征自动显示在特征加工列表中。

4.  配置特征加工。 
    1.  在特征加工列表中，单击需要配置的特征加工右侧**操作**栏下的**配置**，进入特征加工配置页面。
    2.  选择设备数据，单击**下一步**。![选择设备数据](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/1014105/156706454352406_zh-CN.png)


    3.  选择特征表字段，单击**下一步**。![选择特征表字段](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/1014105/156706454452407_zh-CN.png)


    4.  配置关联映射。 
        1.  选择**目标集**。

            ![选择目标集](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/1014105/156706454452410_zh-CN.png)

            **说明：** **目标集**可以为线下的表/topic（不是通过数据建模物理化生成的表/topic），如果线下的表/topic不符合数据建模中对字段和分区要求时，特征加工会失败。建议通过数据建模创建目标表。

        2.  选择**直接映射**，并选择映射的**测点编码**。

            ![选择测点编码](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/1014105/156706454552415_zh-CN.png)

        3.  选择**衍生规则**，单击右侧的**配置**。在**配置表达式**对话框中，填写相关信息，单击**保存**。

            ![选择衍生规则](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/1014105/156706454552413_zh-CN.png)

            |参数|说明|
            |--|--|
            |**表达式命名**|表达式的名称，可自定义。建议您按照命名规范进行命名，方便后续管理。|
            |**使用字段**|选择**目标集**中的一个或多个字段。|
            |**语法**|衍生规则的语法，支持+，-，sin\(\)，cos\(\)，^等算数表达式。|
            |**语法校验**|单击后，可对输入的语法进行校验。校验成功后，系统会提示**语法交验成功**。|

            配置成功后，**衍生规则**显示为**已配置**。

            ![已配置的衍生规则](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/1014105/156706454652417_zh-CN.png)

    5.  配置**开窗设置**，完成后单击**下一步**。 
        1.  单击**目标集**右侧的**开窗设置**。

            ![开窗设置](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/1014105/156706454852418_zh-CN.png)

        2.  在开窗设置对话框中，选择**是否开窗**为是（默认为**否**），选择**聚合函数**为**平均值**，**开窗类型**为**滑动窗口**，**滑窗步长**为**60秒**，**开窗步长**为**10秒**。

            ![开窗设置对话框](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/1014105/156706454952419_zh-CN.png)

        3.  单击**保存**。

            保存成功后，**开窗设置**显示为**开启**。

            ![开启开窗设置](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/1014105/156706454952420_zh-CN.png)

    6.  进行数据过滤规则配置（可不配置），单击**提交**。![配置数据过滤规则](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/1014105/156706454952421_zh-CN.png)

 提交成功后，系统提示**数据保存成功**，并自动返回特征加工页面。
5.  单击特征工程右侧**操作**栏下的**启动**，启动该特征工程。 启动成功后，特征工程的**状态**显示为**运行中**。特征加工上线后，特征加工任务会在后台运行，可在DataWorks平台或DataHub平台查验数据。

    ![特征工程启动成功状态](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/1014105/156706454952423_zh-CN.png)


